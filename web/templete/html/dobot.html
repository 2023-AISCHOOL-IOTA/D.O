<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>채팅봇</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="/templete/css/test.css">

</head>

<body>
    <div class="container mt-4 chat-container">
        <div class="header">
            <div>
                <button onclick="goBack()"><img src="/images/back.jpg" alt="back"></button>
                <img src="/images/good.png" alt="user">
                <span>user</span>
            </div>

        </div>
        <div class="card" id="chat-body">
            <!-- 대화를 동적으로 추가할 공간 -->
        </div>


        <div class="input-container">
            <input type="text" id="message-input" class="form-control mr-2" placeholder="메시지를 입력하세요...">
            <img src="/images/send.png" alt="send" class="send-button" onclick="sendMessage()" width="40px"
                height="40px">
        </div>
    </div>

    <script>
        function goBack() {
            console.log('뒤로가기 버튼 클릭');
        }

        // 채팅창
        function addMessage(message, sender) {
            var chatBody = document.getElementById('chat-body');
            var messageContainer = document.createElement('div');
            var messageBubble = document.createElement('div');
            var messageSender = document.createElement('div');
            var messageTime = document.createElement('div');


            messageContainer.className = 'message-container';
            messageBubble.className = 'message-bubble';
            messageSender.className = 'message-sender';
            messageTime.className = 'message-time';

            messageBubble.textContent = message;
            messageSender.textContent = sender;
            messageTime.textContent = getTime(); // 현재 시간을 얻어옴

            messageContainer.appendChild(messageBubble);
            messageContainer.appendChild(messageSender);
            messageContainer.appendChild(messageTime);


            // 사용자와 챗봇에 따라 클래스를 추가
            if (sender === 'user') {
                messageContainer.classList.add('user-message');
            } else {
                messageContainer.classList.add('chatbot-message');
            }

            chatBody.appendChild(messageContainer);
            chatBody.scrollTop = chatBody.scrollHeight;
        }

        // 현재 시간 함수
        function getTime() {
            var now = new Date();
            var hours = now.getHours();
            var minutes = now.getMinutes();

            // 시간 형식을 맞추기 위해 0을 추가
            hours = hours < 10 ? '0' + hours : hours;
            minutes = minutes < 10 ? '0' + minutes : minutes;

            return hours + ':' + minutes;
        }


        // 입력창
        function sendMessage() {
            var messageInput = document.getElementById('message-input');
            var message = messageInput.value;

            if (message.trim() !== '') {
                addMessage(message, 'user');
                simulateChatbotResponse(message);
                messageInput.value = '';
            }
        }

        // 사용자의 메시지에 대한 챗봇의 응답을 시뮬레이트
        function simulateChatbotResponse(userMessage) {
            var chatbotResponse = (userMessage.includes('안녕') ? '안녕하세요!' : '죄송합니다. 이해하지 못했습니다.');
            addMessage(chatbotResponse, 'DOBOT');
        }

        // Enter 키를 누를 때 sendMessage 함수 호출
        document.getElementById('message-input').addEventListener('keyup', function (event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        });

        // 초기 대화 시작
        setTimeout(function () {
            addMessage('안녕하세요! 어떤 도움이 필요하세요?', 'DOBOT');
        }, 500);
    </script>
</body>

</html>